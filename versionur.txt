Some security checks and added a function!
